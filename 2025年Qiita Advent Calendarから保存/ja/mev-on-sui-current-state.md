---
title:  MEV on Sui: 現状と次のステップ [Sui Foundation Blog]
tags: SUI Web3 Blockchain MEV オブジェクト指向
author: nft
slide: false
---
Sui上でのMEVの仕組み—トランザクション順序付け、保護、公正な競争のためのメカニズム。

![MEV on Sui: Current State and Next Steps](https://blog.sui.io/content/images/size/w2000/2025/02/02-49-Blog-Header.png)

:::note
元記事: [MEV on Sui: Current State and Next Steps](https://blog.sui.io/mev-on-sui-current-state/)
:::

最大抽出可能価値(MEV: Maximum extractable value)は、トランザクションの順序付けと裁定機会を扱うため、ブロックチェーン業界で大きなトピックとなっています。透明性の確保、トランザクションの保護、健全なネットワークの維持、参加者への報酬という観点から、私たちはSui上のMEVをガイドするためにSui改善提案(SIP)やその他のメカニズムを慎重に実装してきました。

現在のメカニズムに加えて、私たちのハイレベルな原則がSui上のMEVの進化をガイドすることを確実にするために、さらに多くのメカニズムを構築する予定です。

## 設計原則と考慮事項

Sui上のすべての取引は、潜在的な利益機会を伴う新しい情報をもたらします。Sui上のMEVエコシステムは、いくつかのメカニズムによって形成されています:

1. MEVトランザクションを送信するためのメカニズム。
2. MEV機会を配信するためのメカニズム。
3. MEV収益を分配するためのメカニズム。
4. ユーザートランザクションを保護するためのメカニズム。

私たちの一般的な優先事項は以下の通りです:

1. ユーザートランザクション保護は、抽出される価値の量よりも重要です。より大きな抽出価値よりも小さなスリッページを優先します。オプトアウトする方法がなくレイテンシを増加させるプロトコル外オークションは避けます。
2. ネットワークの透明性は、バリデータやリレイヤーとのオフライン取引よりも望ましいです。
3. 優先ガスオークション(PGA) による競争を優先し、システムの非効率性につながるスパム行為を抑制します:私たちが目指す完璧なシステムは、サーチャーが抽出価値によって決定される優先手数料でトランザクションを送信することが支配的戦略となるものです。
4. エコシステムに沿った参加者への報酬分配を奨励します:バリデータ、ステーカー、アプリ、ユーザー。

## トランザクション送信

同じObjectを変更するトランザクションは順次実行されるため、クライアントは実行順序の可能性を高めるために競争します。システムの観点から、優先ガスオークション(PGA) は、リソースを割り当て、スパムを防止しながら参加者間でガス代を再分配する効率的な方法です。

優先ガスオークションの主要な推進力は量子化された実行です:

* コンセンサスによって順序付けられたトランザクションは、ブロックで処理されます。トレーダーは、ガスオークションを通じて、コミット内およびコミット間の両方で優先順位を競います。
* これは、実行の優先順位が純粋に速度に依存するCEXマーケットメーカーとは対照的であり、低レイテンシネットワーキングとアルゴリズムによって達成されます。
* より高いコンセンサスコミット率は量子化効果を減少させ、DEX実行をより効率的にしますが、PGAウィンドウを狭めます。
* 現在、非混雑Objectのpgaは最速のサーチャーにのみ重要です。15コミット/秒のSuiレートでは、トランザクション送信速度における70ミリ秒のアドバンテージが決定的要因となります。
  * 混雑したObjectはトランザクション実行を延期する可能性があり、これはPGAの重要性を増幅します。なぜなら、競合するトランザクションのウィンドウが通常のコンセンサスコミットの潜在的に10倍に成長するためです。

特定の今後のSuiコミットにトランザクションを誘導するための2つの別々のメカニズムがあります:

### ソフトバンドル内でトランザクションのバッチを送信する: [SIP-19](https://github.com/sui-foundation/sips/blob/main/sips/sip-19.md?ref=blog.sui.io)

1. ソフトバンドルを介して送信されたトランザクションは、有効なバンドルに対して高い確率で同じコンセンサスコミットに含まれます。バンドルの有効性条件には、とりわけ、すべてのトランザクションで同一のガス価格が必要です。
2. 実際には、このメカニズムは、元のトランザクションとそのバックラントランザクションをバンドルするためのオフチェーンオークションを可能にします。例えば、[Shio](https://www.getshio.com/explorer?ref=blog.sui.io)によって実行されるものなどです。

### コンセンサス増幅によるトランザクションの優先順位付け: [SIP-45](https://github.com/sui-foundation/sips/blob/main/sips/sip-45.md?ref=blog.sui.io)

1. SIP-45は、コンセンサス送信における潜在的なジッターの問題に取り組んでいます。ジッターとは、ガス価格が高いトランザクションが、同時に送信されたガス価格が低いトランザクションよりも後のコミットで順序付けられる現象です。
2. コンセンサス送信には2つの自然なジッター源があります:
   1. 送信するバリデータがいくつかのコンセンサスラウンドで遅れている:別のバリデータによって送信されたトランザクションが最初に順序付けられる可能性があります。
   2. コンセンサスラウンドのリーダーであるバリデータは、他のバリデータの送信に対して1ラウンドのアドバンテージを持っています。
3. SIP-45は、k x RGP(kは現在の構成で5に設定されているシステムパラメータ、RGPは参照ガス価格)よりも高いガス価格のコンセンサス送信を増幅します。n x RGPのガス価格を持つトランザクションは、n回増幅されます。
4. アプリビルダーとユーザーの両方によるSIP-45のより広範な採用は、公正な競争を伴うより効率的なシステムを作成します。
   1. SIP-45はクライアントの観点からシステムの基本的な特性を変更しないことに注意することが重要です:より効率的な代替手段を提供することでスパムを抑止します。

### トランザクションの適切なガス価格の選択

クライアントが送信するトランザクションのガス価格を決定する際に考慮すべき2つの主要な要因があります:

1. 優先ガスオークション。
   * コンセンサスコミット内で、同じObjectを変更するトランザクションはガス価格によって順序付けられ、サーチャー間で公正な競争が生まれます。
2. コンセンサス送信増幅。
   * 上記のように、5 x RGPを超えるガス価格は、n個のバリデータが特定のトランザクションをコンセンサスに送信することでコンセンサス送信を増幅します。増幅閾値を超えるガス価格の増加は、低パフォーマンス送信ジッターの確率を減少させます。実際には、増幅係数5はジッターを排除するのに十分であり、100 x RGPのガス価格は高い確率で次のラウンドのリーダー送信をアンロックします。
3. 混雑による延期とキャンセルの回避。
   * Suiは、同じShared Objectを変更するトランザクションのレートを制御することにより、チェックポイント実行のウォールクロック時間を制限します。混雑したObjectを変更するトランザクションはガス価格に従って順序付けられ、低価格のトランザクションは延期され、最終的にキャンセルされて、チェックポイントごとの順次実行の最長チェーンを制限します。これは[Objectベースのローカル手数料市場](https://docs.sui.io/guides/developer/advanced/local-fee-markets?ref=blog.sui.io)と呼ばれるメカニズムです。*(高い裁定機会を提供するShared Objectのガス価格は急上昇する可能性がありますが、システムの残りの部分では変わらないことに注意してください。)*
   * Full Nodeは、混雑したObjectを変更する実行されたトランザクションとキャンセルされたトランザクションの両方のガス価格を追跡します。トランザクションのドライランの結果には、特定のリクエストによって変更された混雑したObjectの最低価格実行トランザクションと最高価格キャンセルトランザクションのガス価格の両方が含まれます。この情報により、クライアントは高い確率で延期を回避するために必要なガス価格を決定できます。*(この作業は部分的にのみ実装されており、今後2ヶ月以内にSDKの一部になる予定です。)*

## トランザクション情報の配信

Sui上の各トランザクションは、潜在的な利益機会を伴う情報をもたらします。クライアントによって送信された瞬間から第三者によってその影響が観察されるまでの、Shared Objectトランザクションのハッピーパスライフサイクルを考えてみましょう:

![](https://blog.sui.io/content/images/2025/02/mermaid-diagram-2025-02-25-130957--1-.png)

1. クライアントがRPC Full Node(通常はアプリによって選択される)にトランザクションを送信します。
2. RPCノードがトランザクションをバリデータにブロードキャストし、バリデータはその有効性を検証して署名します。RPCノードはクォーラムからトランザクション証明書を組み立てます。
3. RPCノードがトランザクション証明書をバリデータにブロードキャストします。
4. 決定論的に選択されたバリデータがトランザクションをコンセンサスに送信します。Mysticetiコンセンサスはバリデータ間でブロックをブロードキャストし、3つのコンセンサスラウンドで、特定のトランザクションを含むブロックがコミットされます。
   1. トランザクションは各バリデータで実行されます
5. トランザクション効果証明書がRPCノードとクライアントに送り返されます。
6. 1から3のコンセンサスラウンド内で、各バリデータはチェックポイントを形成して署名します(チェックポイントは複数のコンセンサスコミットをバッチ処理します)。
7. チェックポイント署名がバリデータ間でブロードキャストされ、各バリデータがチェックポイント証明書を形成します。
8. state-syncプロトコルは、p2p方式で認証されたチェックポイントを配信する責任があります。通常、各バリデータには、RPCリクエストを提供しないダイレクトピアがあります:state-sync Full Nodeで、最初にチェックポイントを受信します。
9. state-sync Full Nodeに接続されている第三者Full Nodeがチェックポイントについて学習し、そのコンテンツをダウンロードします。この時点で、Full Nodeに直接接続されている第三者がこのトランザクションの影響を後処理し、それに応じて反応できると仮定します。

### バリデータ送信前のトランザクション情報の配信

前のセクションで説明したように、[SIP-19](https://github.com/sui-foundation/sips/blob/main/sips/sip-19.md?ref=blog.sui.io)に従ってソフトバンドルを送信するためのSuiオフチェーンオークションがあります。これらのオークションは、アプリとオークションシステム間のオフチェーン合意を介してトランザクション送信を傍受します。例えば、[Shio](https://www.getshio.com/explorer?ref=blog.sui.io)によって実行されるものなどです。

このタイプの情報配信は、潜在的なサンドイッチ攻撃からユーザートランザクションを保護する適切に動作するオークションシステムを前提としています。Shioは、ビジネスを維持するためにユーザートランザクションを保護するインセンティブを持っているため、潜在的なサンドイッチボットの財務的収益性を損なうために、いくつかのオークション技術(おとりトランザクション、ランダム遅延)を採用しています。

明らかに、このタイプの情報配信はSuiの外部で行われ(アプリとオークションの間)、アプリとユーザーにとってオプトインであり、投機的な情報のみを提供し、元のユーザートランザクションが成功する保証はありません。

### コンセンサスブロックのストリーミング

ユーザートランザクションへの低遅延アクセスを民主化するために、コンセンサスブロックの直接ストリーミングシステムを設計しています。高レベルでは、Full Nodeがコンセンサスブロックに直接サブスクライブするオプションを持つことになります。

このようにして、Full Nodeは高い確率でコミットされる予定のトランザクションについて投機的に通知するオプションを持ちます。ネットワークトポロジは、標準のオープンstate-syncピア発見プロトコルを使用しています。

投機的通知は、バリデータ送信から約160ミリ秒(2つのコンセンサスラウンド)までトランザクションに関する伝播遅延を大幅に短縮する可能性があります。

コンセンサスブロックストリーミングプロジェクトは現在設計段階にあり、今後1〜2ヶ月以内にSIPを持つことを期待しています。

## ユーザートランザクションの保護

ユーザートランザクションは、略奪的なフロントランニング、サンドイッチング、および非自発的な送信遅延から保護される必要があります。

### 外部クォーラム駆動

Suiトランザクション送信には外部クォーラム駆動が必要であり、これは通常Full Nodeによって実行されます。

![](https://blog.sui.io/content/images/2025/02/image.png)

トランザクションtのトランザクション送信リクエストを受信するバリデータが新しいトランザクションt'を開始したい場合、証明書組み立てプロセスで元のクォーラムドライバーより遅れます。送信するFull NodeがSuiクォーラムへの接続が不良でない限り、元のトランザクションに応答してt'のクォーラム駆動を開始するバリデータは、tの後に証明書を組み立てます。

さらに、tのコンセンサス送信は分散化されているため、その証明書がクォーラムに到達すると確実に延期することはできません。したがって、tの証明書がt'の証明書の前にSuiクォーラムに到達すると、tは高い確率でt'の前に決済されます。

したがって、外部クォーラム駆動の事実そのものが、トランザクション送信を担当するFull Nodeへの信頼を前提として、自然なフロントランニング保護を提供します(フロントランニングの略奪的試みはオンチェーンで容易に検出されるため、これらの試みはクライアントによって注目され、RPCオペレーターの評判を傷つけます)。

### Mysticetiファストパス

現在、Mysticeti [論文](https://arxiv.org/abs/2310.14821?ref=blog.sui.io)で説明されているファストパスプロトコルにトランザクション送信を変更するプロジェクトに取り組んでいます。このプロトコルによれば、ユーザートランザクションは単一のバリデータに送信でき、そのバリデータはトランザクション証明書の収集と実行にMysticetiを活用します。システムを大幅に効率化する一方で、ユーザートランザクションを受信するバリデータにフロントランニングの機会を開きます。

このリスクは純粋に仮説的なものです。なぜなら、今日Sui上でフロントランニングの試みの証拠がないためです。新しいセットアップでは、フロントランの可能性は高くなりますが、一方で、送信するバリデータに関する決定論的な知識があるため、責任を問いやすくなります。

## Suiの進化するMEVランドスケープ

SuiのMEVランドスケープはまだ形成中であり、今年後半に新しいメカニズムが登場します。優先ガスオークションとコンセンサス増幅が現在のシステムを定義している一方で、タイムロック暗号化やMysticetiのファストパスなどの今後のイノベーションは、トランザクション実行とセキュリティを再形成します。これらの要素がオンラインになるにつれて、Sui上のMEVは進化し続け、よりダイナミックで透明なエコシステムを作り出します。
