[DEEPトークンのDeepBookガバナンスにおける役割](https://blog.sui.io/deep-token-deepbook-governance/)

## Sui上のMEV: 現状と次のステップ

Sui上でのMEVの仕組み—トランザクションの順序付け、保護、公正な競争のためのメカニズム。

* [![Mysten Labs](https://blog.sui.io/content/images/size/w100/2023/11/MystenLabs_Logomark_Red-4.png)](https://blog.sui.io/author/mysten/)

![MEV on Sui: Current State and Next Steps](https://blog.sui.io/content/images/size/w2000/2025/02/02-49-Blog-Header.png)

Maximum extractable value（MEV）は、トランザクションの順序付けとアービトラージの機会を扱うため、ブロックチェーン業界で大きな話題となっています。透明性の確保、トランザクションの保護、健全なネットワークの維持、参加者への報酬を目的として、Sui上のMEVを導くためのSui improvement proposals（SIP）やその他のメカニズムを慎重に実装してきました。

現在のメカニズムに加えて、Sui上のMEVの進化を導く高レベルの原則を確実にするために、さらに多くのメカニズムを構築する予定です。

## 設計原則と考慮事項

Sui上のすべての取引は、潜在的な利益機会を伴う新しい情報をもたらします。Sui上のMEVエコシステムは、いくつかのメカニズムによって形成されています:

1. **MEVトランザクションを提出する**ためのメカニズム。
2. **MEV機会を広める**ためのメカニズム。
3. **MEV収益を分配する**ためのメカニズム。
4. **ユーザートランザクションを保護する**ためのメカニズム。

私たちの一般的な優先事項は以下の通りです:

1. ユーザーの**トランザクション保護**は、抽出される価値の量よりも重要です。より大きな抽出価値よりも小さなスリッページを優先します。オプトアウトする方法がなくレイテンシを増加させるプロトコル外のオークションを避けます。
2. **ネットワークの透明性**は、バリデータやリレイヤーとのオフラインでの取引よりも望ましいです。
3. **priority gas auctions（PGA）**を通じた競争を優先し、システムの非効率性につながるスパム行為を抑制します: 私たちが目指す完璧なシステムは、サーチャーが抽出された価値によって決定される優先手数料でトランザクションを送信することを支配的な戦略にします。
4. エコシステムに連携する参加者への**報酬分配**を奨励します: バリデータ、ステーカー、アプリ、ユーザー。

## トランザクション提出

同じObjectを変更するトランザクションは順次実行されるため、クライアントは実行順序の可能性を高めるために競争します。システムの観点から、**priority gas auctions（PGA）**は、参加者間でガス手数料を再分配しながら、リソースを割り当て、スパムを防ぐ効率的な方法です。

priority gas auctionsの主要な推進力は**量子化された実行**です:

* コンセンサスによって順序付けられたトランザクションは、ブロック単位で処理されます。トレーダーは、ガスオークションを通じて、コミット**内**および**間**の優先順序を競います。
* これは、実行優先度が純粋に速度に依存し、低レイテンシネットワークとアルゴリズムによって達成されるCEXマーケットメーカーとは対照的です。
* より高いコンセンサスコミットレートは**量子化効果を減少させ**、DEXの実行をより効率的にしますが、PGAウィンドウを狭めます。
* 現在、非輻輳ObjectのPGAは最も速いサーチャーにとってのみ重要です。**15コミット/秒**のSuiレートでは、トランザクション提出速度における70ミリ秒の優位性が決定的な要因となります。
  * 輻輳したObjectはトランザクション実行を遅らせる可能性があり、競合するトランザクションのウィンドウが通常のコンセンサスコミットの最大10倍に成長する可能性があるため、PGAの重要性が増幅されます。

特定の今後のSuiコミットに向けてトランザクションを誘導するための2つの個別のメカニズムがあります:

### ソフトバンドル内でのトランザクションのバッチ提出: [SIP-19](https://github.com/sui-foundation/sips/blob/main/sips/sip-19.md?ref=blog.sui.io)

1. ソフトバンドルを介して提出されたトランザクションは、有効なバンドルに対して高い確率で同じコンセンサスコミットに含まれます。バンドルの有効性条件には、特に、すべてのトランザクションに対して同一のガス価格が必要です。
2. 実際には、このメカニズムは、元のトランザクションとそのバックラントランザクションをバンドルするためのオフチェーンオークションを可能にします。例えば、[Shio](https://www.getshio.com/explorer?ref=blog.sui.io)によって実行されるものです。

### コンセンサス増幅によるトランザクションの優先順位付け: [SIP-45](https://github.com/sui-foundation/sips/blob/main/sips/sip-45.md?ref=blog.sui.io)

1. SIP-45は、同時に提出された低いガス価格のトランザクションよりも、高いガス価格のトランザクションが後のコミットで順序付けられるという、コンセンサス提出における潜在的なジッターの問題に取り組んでいます。
2. コンセンサス提出には2つの自然なジッターソースがあります:
   1. 提出するバリデータがいくつかのコンセンサスラウンド遅れている: 別のバリデータによって提出されたトランザクションが最初に順序付けられる可能性があります。
   2. コンセンサスラウンドのリーダーであるバリデータは、他のバリデータの提出よりも1ラウンドの優位性を持っています。
3. SIP-45は、k x RGPより高いガス価格のコンセンサス提出を増幅します（kは現在の構成で5に設定されているシステムパラメータで、RGPはreference gas priceです）。n x RGPのガス価格を持つトランザクションは、n回増幅されます。
4. アプリ構築者とユーザーの両方による**SIP-45のより広範な採用**は、公正な競争を伴うより効率的なシステムを作り出します。
   1. SIP-45は、クライアントの観点からシステムの基本的な特性を変更しないことに注意することが重要です: より効率的な代替手段を提供することで**スパムを抑止します**。

### トランザクションに適切なガス価格を選択する

提出されたトランザクションのガス価格を決定するためにクライアントが考慮すべき2つの主要な要因があります:

1. **Priority gas auction。**
   * コンセンサスコミット内では、同じObjectを変更するトランザクションは**ガス価格によって順序付けられ**、サーチャー間で公正な競争が生まれます。
2. **コンセンサス提出増幅。**
   * 上記のように、5 x RGPを超えるガス価格は、nバリデータが所定のトランザクションをコンセンサスに提出することで**コンセンサス提出を増幅**します。増幅閾値を超えるガス価格の増加は、低パフォーマンス提出ジッターの確率を減少させます。実際には、増幅係数5はジッターを排除するのに十分ですが、100 x RGPのガス価格は高い確率で次のラウンドのリーダー提出をアンロックします。
3. **輻輳の延期とキャンセルを回避する。**
   * Suiは、同じShared Objectを変更するトランザクションの速度を制御することにより、チェックポイント実行のウォールクロック時間を制限します。輻輳したObjectを変更するトランザクションは、ガス価格に従って順序付けられ、チェックポイントごとの順次実行の最長チェーンを制限するために、低価格のトランザクションが延期され、最終的にキャンセルされます。これは[**object-based local fee markets**](https://docs.sui.io/guides/developer/advanced/local-fee-markets?ref=blog.sui.io)と呼ばれるメカニズムです。*（高いアービトラージ機会を提供するShared Objectのガス価格は急騰する可能性がありますが、システムの残りの部分では変更されないことに注意してください。）*
   * Full Nodeは、輻輳したObjectを変更する実行されたトランザクションとキャンセルされたトランザクションの両方のガス価格を追跡します。したがって、**トランザクションのドライランの結果**には、所定のリクエストによって変更された輻輳したObjectに対する最低価格実行および最高価格キャンセルトランザクションのガス価格の両方を含めることができます。この情報により、クライアントは高い確率で延期を回避するために必要なガス価格を決定できます。*（この作業は部分的にのみ実装されており、今後2か月以内にSDKの一部になる予定です。）*

## トランザクション情報の広め方

Sui上の各トランザクションは、潜在的な利益機会を伴う情報をもたらします。クライアントによって提出された瞬間から、その効果が第三者によって観察されるまでのShared Objectトランザクションのハッピーパスライフサイクルを考えてみましょう:

![](https://blog.sui.io/content/images/2025/02/mermaid-diagram-2025-02-25-130957--1-.png)

1. クライアントは、RPC Full Node（通常はアプリによって選択される）にトランザクションを提出します。
2. RPCノードは、トランザクションをバリデータにブロードキャストし、バリデータはその有効性を検証して署名し、RPCノードはクォーラムからトランザクション証明書を組み立てます。
3. RPCノードは、トランザクション証明書をバリデータにブロードキャストします。
4. 決定論的に選ばれたバリデータが、トランザクションをコンセンサスに提出します。Mysticetiコンセンサスは、バリデータ間でブロックをブロードキャストし、3つのコンセンサスラウンドで、所定のトランザクションを含むブロックがコミットされます。
   1. トランザクションは各バリデータで実行されます
5. トランザクション効果証明書は、RPCノードとクライアントに送り返されます。
6. 1〜3のコンセンサスラウンド内で、各バリデータはチェックポイントを形成して署名します（チェックポイントは複数のコンセンサスコミットをバッチ処理します）。
7. チェックポイント署名はバリデータ間でブロードキャストされ、各バリデータはチェックポイント証明書を形成します。
8. ステートシンクプロトコルは、p2p方式で認証されたチェックポイントを広める責任があります。通常、各バリデータには、RPCリクエストを提供していない直接のピア（ステートシンクFull Node）があり、最初にチェックポイントを受け取ります。
9. ステートシンクFull Nodeに接続されている第三者Full Nodeがチェックポイントについて学習し、そのコンテンツをダウンロードします。この瞬間、Full Nodeに直接接続されている第三者がこのトランザクションの効果を後処理し、それに応じて反応できると仮定します。

### バリデータ提出前のトランザクション情報の広め方

前のセクションで説明したように、[SIP-19](https://github.com/sui-foundation/sips/blob/main/sips/sip-19.md?ref=blog.sui.io)に従ってソフトバンドルを提出するためのSuiオフチェーンオークションがあります。これらのオークションは、**アプリとオークションシステム間のオフチェーン合意**を介してトランザクション提出を傍受します。例えば、[Shio](https://www.getshio.com/explorer?ref=blog.sui.io)によって実行されるものです。

このタイプの情報広めは、潜在的なサンドイッチ攻撃からユーザートランザクションを保護する、適切に動作するオークションシステムを前提としています。Shioは、ビジネスを維持するためにユーザートランザクションを保護する動機があり、したがって、潜在的なサンドイッチボットの財務的収益性を損なうために、いくつかのオークション技術（おとりトランザクション、ランダムな遅延）を採用しています。

明らかに、このタイプの情報広めは、Sui外（アプリとオークションの間）で発生し、アプリとユーザーにとってオプトインであり、投機的な情報のみを提供し、元のユーザートランザクションが成功する保証はありません。

### コンセンサスブロックのストリーミング

ユーザートランザクションへの低遅延アクセスを民主化するために、コンセンサスブロックの直接ストリーミングのためのシステムを設計しています。高レベルでは、Full Nodeはコンセンサスブロックに直接サブスクライブするオプションを持つことになります。

このようにして、Full Nodeは、高い確率でコミットされるトランザクションについて投機的に通知するオプションを持つことになります。ネットワークトポロジーは、標準のオープンステートシンクピア検出プロトコルを使用しています。

投機的通知は、バリデータ提出以降、約160ミリ秒（2コンセンサスラウンド）にトランザクションに関する伝播遅延を大幅に短縮する可能性があります。

コンセンサスブロックストリーミングプロジェクトは現在設計段階にあり、今後1〜2か月以内にSIPを作成する予定です。

## ユーザートランザクションの保護

ユーザートランザクションは、略奪的なフロントランニング、サンドイッチング、不本意な提出遅延から保護される必要があります。

### 外部クォーラム駆動

Suiトランザクション提出には、通常Full Nodeによって実行される外部クォーラム駆動が必要です。

![](https://blog.sui.io/content/images/2025/02/image.png)

トランザクションtのトランザクション提出リクエストを受け取るバリデータが新しいトランザクションt'を開始したい場合、証明書組み立てプロセスで元のクォーラムドライバーより遅れることになります。提出Full NodeがSuiクォーラムに不十分に接続されていない限り、元のトランザクションに応答してt'のクォーラム駆動を開始するバリデータは、tの後に証明書を組み立てます。

さらに、tのコンセンサス提出は分散化されているため、証明書がクォーラムに到達すると、確実に延期することはできません。したがって、tの証明書がt'の証明書の前にSuiクォーラムに到達すると、tは高い確率でt'の前に決済されます。

したがって、外部クォーラム駆動の事実自体が、トランザクション提出を担当するFull Nodeへの信頼を前提として、自然なフロントランニング保護を提供します（フロントランニングの略奪的試みはオンチェーンで簡単に検出されるため、これらの試みはクライアントによって注目され、RPCオペレーターの評判を傷つけます）。

### Mysticeti fast path

現在、Mysticeti[論文](https://arxiv.org/abs/2310.14821?ref=blog.sui.io)で説明されているfast pathプロトコルにトランザクション提出を変更するプロジェクトに取り組んでいます。このプロトコルによれば、ユーザートランザクションは単一のバリデータに提出でき、そのバリデータはトランザクション証明書の収集と実行にMysticetiを活用します。システムを大幅に効率化する一方で、ユーザートランザクションを受け取るバリデータにフロントランニングの機会を開きます。

このリスクは純粋に仮説的です。現在、Sui上でフロントランニング試みの証拠はありません。新しい設定では、フロントランの可能性は高くなりますが、一方で、提出するバリデータに関する決定論的知識が与えられれば、それらの責任を追及しやすくなります。

## Suiの進化するMEVランドスケープ

SuiのMEVランドスケープはまだ形成途中であり、今年後半に新しいメカニズムが登場します。priority gas auctionsとコンセンサス増幅が現在のシステムを定義していますが、タイムロック暗号化やMysticetiのfast pathのような今後のイノベーションが、トランザクション実行とセキュリティを再形成します。これらの要素がオンラインになるにつれて、Sui上のMEVは進化を続け、より動的で透明なエコシステムを創出します。
